<div class="container" style="height: 100%!; padding-bottom: 20%">
  @if(patient){
  <div>
    <h1>Ficha Demanda</h1>
    <h4>Paciente > {{ patient.name }} {{ patient.surname }} {{ patient.secondSurname }}</h4>
    <form [formGroup]="demandForm" autocomplete="off" (ngSubmit)="onSaveDemand()">
      <div class="grid pt-4">
        <div class="col-4">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>Sustancia Principal</mat-label>
            <mat-select formControlName="mainSubstance">
              <mat-option value="1">Alcohol</mat-option>
              <mat-option value="2">Marihuana</mat-option>
              <mat-option value="3">Cocaína</mat-option>
              <mat-option value="4">Pasta Base</mat-option>
              <mat-option value="5">Crack</mat-option>
              <mat-option value="6">Inhalables</mat-option>
              <mat-option value="7">Extasis</mat-option>
              <mat-option value="8">LSD</mat-option>
              <mat-option value="9">Fenilciclidina</mat-option>
              <mat-option value="10">Hongos</mat-option>
              <mat-option value="11">Otros Alucinógenos</mat-option>
              <mat-option value="12">Heroína</mat-option>
              <mat-option value="13">Metadona</mat-option>
              <mat-option value="14">Otros Opioides Analgésicos</mat-option>
              <mat-option value="15">Anfetaminas</mat-option>
              <mat-option value="16">Metanfetaminas y otros derivados</mat-option>
              <mat-option value="17">Otros Estimulantes</mat-option>
              <mat-option value="18">Sedantes</mat-option>
              <mat-option value="19">Hipnóticos</mat-option>
              <mat-option value="20">Esteroides Anabólicos</mat-option>
              <mat-option value="21">Otros</mat-option>
              <mat-option value="24">Tranquilizantes</mat-option>
              <mat-option value="25">Sin especificar</mat-option>
              <mat-option value="26">Tussi/Ketamina</mat-option>
              <mat-option value="27">Fentanilo</mat-option>
            </mat-select>
            <!-- <span *ngIf="isValidField('mainSubstance')" class="text-red-500">
                  Debe seleccionar un programa
                </span> -->
          </mat-form-field>
        </div>
        <div class="col-3">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>N° Tratamientos Previos</mat-label>
            <mat-select formControlName="previousTreatments">
              <mat-option value="">Seleccione</mat-option>
              <mat-option value="0">0</mat-option>
              <mat-option value="1">1</mat-option>
              <mat-option value="2">2</mat-option>
              <mat-option value="3">3</mat-option>
              <mat-option value="4">4</mat-option>
              <mat-option value="5">5</mat-option>
              <mat-option value="6">6</mat-option>
              <mat-option value="7">7</mat-option>
              <mat-option value="8">8</mat-option>
              <mat-option value="9">9</mat-option>
              <mat-option value="10">10</mat-option>
            </mat-select>
            <!-- <span *ngIf="isValidField('previousTreatments')" class="text-red-500">
                  Debe seleccionar un programa
                </span> -->
          </mat-form-field>
        </div>
      </div>

      <div class="grid">
        <div class="col-5">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>Fecha Solicitud de Antención en el establecimiento</mat-label>
            <input matInput [matDatepicker]="pickerAtentionRequestDate" formControlName="atentionRequestDate" />
            <!-- <mat-hint>MM/DD/YYYY</mat-hint> -->
            <mat-datepicker-toggle matIconSuffix [for]="pickerAtentionRequestDate"></mat-datepicker-toggle>
            <mat-datepicker #pickerAtentionRequestDate></mat-datepicker>
          </mat-form-field>
        </div>
      </div>

      <div class="grid">
        <div class="col-4">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>Tipo Contacto</mat-label>
            <mat-select formControlName="typeContact">
              <mat-option value="">Seleccione</mat-option>
              <mat-option value="1">Presencial</mat-option>
              <mat-option value="2">Telefonica</mat-option>
              <mat-option value="3">Correo Postal</mat-option>
              <mat-option value="4">Digital</mat-option>
              <mat-option value="5">Otra</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-4">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>¿Quién solicita?</mat-label>
            <mat-select formControlName="whoRequest">
              <mat-option value="">Seleccione</mat-option>
              <mat-option value="1">Usuario Directamente</mat-option>
              <mat-option value="2">Familiar</mat-option>
              <mat-option value="3"> Sector Justicia (Fiscal, Juzgado, Consejero, etc) </mat-option>
              <mat-option value="4">Otro Centro de Salud</mat-option>
              <mat-option value="5">Otro Centro de Tratamiento</mat-option>
              <mat-option value="6">Previene</mat-option>
              <mat-option value="7">Empresa</mat-option>
              <mat-option value="8"> Servicios Sociales (Iglesias, servicios Comunitarios) </mat-option>
              <mat-option value="9">Colegio</mat-option>
              <mat-option value="10">Otro</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>

      <div class="grid">
        <div class="col-4">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>¿Quién deriva?</mat-label>
            <mat-select formControlName="whoDerives">
              <mat-option value="">Seleccione</mat-option>
              <mat-option value="1">Demanda Espontanea</mat-option>
              <mat-option value="2">Derivado de otro centro de Salud</mat-option>
              <mat-option value="3">Derivado de otro centro de Tratamiento</mat-option>
              <mat-option value="4"> Referido desde Sector Justicia (fiscal, juzgado, c </mat-option>
              <mat-option value="5">Referido desde una Empresa</mat-option>
              <mat-option value="6">Referido desde un Colegio</mat-option>
              <mat-option value="7"> Referido desde algÃºn Servicio Social (iglesia, se </mat-option>
              <mat-option value="8">Referido desde el Previene</mat-option>
              <mat-option value="9">Otro Especificar</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>

      <div class="grid">
        <div class="col-6">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>Fecha atención ofrecida (citación) en el establecimiento</mat-label>
            <input matInput [matDatepicker]="pickerCareOfferedDate" formControlName="careOfferedDate" />
            <!-- <mat-hint>MM/DD/YYYY</mat-hint> -->
            <mat-datepicker-toggle matIconSuffix [for]="pickerCareOfferedDate"></mat-datepicker-toggle>
            <mat-datepicker #pickerCareOfferedDate></mat-datepicker>
          </mat-form-field>
        </div>
      </div>

      <div class="grid">
        <div class="col-4">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>Si no fue posible dar una hora de atención (mes estimado)</mat-label>
            <input matInput [matDatepicker]="pickerEstimatedMonth" formControlName="estimatedMonth" />
            <!-- <mat-hint>MM/DD/YYYY</mat-hint> -->
            <mat-datepicker-toggle matIconSuffix [for]="pickerEstimatedMonth"></mat-datepicker-toggle>
            <mat-datepicker #pickerEstimatedMonth></mat-datepicker>
          </mat-form-field>
        </div>
        <div class="col-4">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>No se Acepta Demanda </mat-label>
            <mat-select formControlName="demandIsNotAccepted">
              <mat-option value="">Seleccione</mat-option>
              <mat-option value="1">Por Prevision de Salud</mat-option>
              <mat-option value="2">Jurisdiccion</mat-option>
              <mat-option value="3">Diagnostico</mat-option>
              <mat-option value="4">Otro</mat-option>
            </mat-select>
            <!-- <span *ngIf="isValidField('demandIsNotAccepted')" class="text-red-500">
                  Debe seleccionar un programa
                </span> -->
          </mat-form-field>
        </div>
      </div>

      <div class="grid">
        <div class="col-4">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>(a) Fecha 1era atención realizada</mat-label>
            <input matInput [matDatepicker]="pickerFirstAtentionDate" formControlName="firstAtentionDate" />
            <!-- <mat-hint>MM/DD/YYYY</mat-hint> -->
            <mat-datepicker-toggle matIconSuffix [for]="pickerFirstAtentionDate"></mat-datepicker-toggle>
            <mat-datepicker #pickerFirstAtentionDate></mat-datepicker>
          </mat-form-field>
        </div>
        <div class="col-4">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>(b) Fecha ofrecida de atención resolutiva</mat-label>
            <input matInput [matDatepicker]="pickerAtentionResolutiveDate" formControlName="atentionResolutiveDate" />
            <!-- <mat-hint>MM/DD/YYYY</mat-hint> -->
            <mat-datepicker-toggle matIconSuffix [for]="pickerAtentionResolutiveDate"></mat-datepicker-toggle>
            <mat-datepicker #pickerAtentionResolutiveDate></mat-datepicker>
          </mat-form-field>
        </div>
      </div>

      <div class="grid">
        <div class="col-4">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label> Recibió Interveciones entre a y b</mat-label>
            <mat-select formControlName="interventionAB">
              <mat-option value="">Seleccione</mat-option>
              <mat-option value="1">Si</mat-option>
              <mat-option value="2">No</mat-option>
            </mat-select>
            <!-- <span *ngIf="isValidField('interventionAB')" class="text-red-500">
                  Debe seleccionar un programa
                </span> -->
          </mat-form-field>
        </div>
        <div class="col-5">
          <mat-form-field class="w-full" appearance="outline">
            <mat-label>Observaciones</mat-label>
            <textarea matInput formControlName="observations"></textarea>
            <!-- <span *ngIf="isValidField('observations')" class="form-text text-danger">
                  El nombre es requerido
                </span> -->
            <mat-icon matSuffix>person</mat-icon>
            <!-- <mat-hint>Hint</mat-hint> -->
          </mat-form-field>
        </div>
      </div>

      <div>
        <button mat-stroked-button color="primary" routerLink="../" class="mr-1">Volver</button>
        <button mat-flat-button type="submit" color="primary" [disabled]="patient.registeredDemand">Registrar</button>
        @if(patient.registeredDemand || registeredDemand){
        <button mat-flat-button class="ml-1" type="button" color="primary" (click)="onSaveDemandOnSistrat()">Registrar en SISTRAT</button>

        }
      </div>
    </form>
  </div>
  }
</div>
